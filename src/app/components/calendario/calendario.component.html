<body>
    <div class="form-container">
        <!-- Contenido del contenedor izquierdo -->
        <br>
        <h2 style="text-align: center;">Calendario</h2>

        <div class="input-container">
            <form [formGroup]="formulario" (ngSubmit)="onSubmit()">
                <span>Rango:</span>
                <input type="date" id="fechaFrom" formControlName="fechaFrom" placeholder="Ingrese la Fecha">
                <span>a</span>
                <input type="date" id="fechaTo" formControlName="fechaTo" placeholder="Ingrese la Fecha">

                <input type="submit" class="btnAceptar" id="btnAceptar" value="Filtrar">
            </form>
        </div>

    </div>

    <div class="table-eventosData-container">
        <table class="table-eventosData">
            <thead>
                <tr>
                    <th>Cliente</th>
                    <th>Evento</th>
                    <th>Direcci√≥n</th>
                    <th>Fecha y Hora</th>
                    <th>Nombre Paquete</th>
                    <th>Monto</th>
                    <th>Pagado</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let evento of eventosData" [style.background-color]="calcularColorFila(evento)">
                    <td>{{evento.nombresCliente}}</td>
                    <td>{{evento.nombreEvento}}</td>
                    <td>{{evento.dirEvento}}</td>
                    <td>{{evento.fechaYHora}}</td>
                    <td>{{evento.nombrePaquete}}</td>
                    <td>${{evento.monto}}</td>
                    <td>${{evento.montoPagado || 0}}</td>
                    <td>
                        <button *ngIf="!estaCompletamentePagado(evento)" class="btn btn-outline-primary me-2"
                            (click)="abrirPopupPago(evento)">
                            Pagar
                        </button>
                        <button class="btn btn-outline-danger" (click)="onClickDelete(evento)">
                            Eliminar
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <div class="export-container">
        <button class="btn btn-primary" (click)="exportarPDF()">Exportar a PDF</button>
    </div>
    
    <!-- Popup de Pago -->
    <div class="popup" *ngIf="showPagoPopup">
        <div class="popup-content">
            <h3>Registrar Pago</h3>
            <p>Monto total: ${{eventoSeleccionado?.monto}}</p>
            <p>Monto pagado: ${{eventoSeleccionado?.montoPagado || 0}}</p>
            <p>Restante: ${{eventoSeleccionado?.monto || 0 - (eventoSeleccionado?.montoPagado || 0)}}</p>
            <input #cantidadPago type="number"
                [max]="eventoSeleccionado?.monto || 0 - (eventoSeleccionado?.montoPagado || 0)"
                placeholder="Cantidad a pagar">
            <div class="popup-buttons">
                <button (click)="registrarPago(+cantidadPago.value)">Registrar Pago</button>
                <button (click)="showPagoPopup = false">Cancelar</button>
            </div>
        </div>
    </div>
</body>
